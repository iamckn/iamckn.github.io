<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Sniffing Gsm Traffic | The poetry of (in)security</title>
  <link rel = 'canonical' href = 'https://example.org/blog/2015/11/01/sniffing-gsm-traffic/'>
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Sniffing Gsm Traffic" />
<meta property="og:description" content="I have been playing around with the HackRF for the past couple of weeks and progressively exploring the Radio Frequency spectrum. In this post I&rsquo;ll take you through how to sniff GSM traffic. I&rsquo;ll be specifically monitoring the Um interface. This in the air interface between the Mobile Station (MS) and the Base Transceiver Station (BTS). The MS in this case will be the mobile phone while the BTS is what the phone connects to on the Mobile network. The BTS is usually hosted on towers which you can spot in various locations. Here is what a typical one looks like." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.org/blog/2015/11/01/sniffing-gsm-traffic/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2015-11-01T09:30:27+03:00" />
<meta property="article:modified_time" content="2015-11-01T09:30:27+03:00" />


  <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Sniffing Gsm Traffic"/>
<meta name="twitter:description" content="I have been playing around with the HackRF for the past couple of weeks and progressively exploring the Radio Frequency spectrum. In this post I&rsquo;ll take you through how to sniff GSM traffic. I&rsquo;ll be specifically monitoring the Um interface. This in the air interface between the Mobile Station (MS) and the Base Transceiver Station (BTS). The MS in this case will be the mobile phone while the BTS is what the phone connects to on the Mobile network. The BTS is usually hosted on towers which you can spot in various locations. Here is what a typical one looks like."/>

  
  
  
  <link rel="stylesheet" href="https://example.org/css/styles.e6089d87700a06caa386c15bac0e1f25720ef059b3e065c0a37502617f43d5e1ef54d1c10e3f4be773eb071ea4ae80b46775fad1ad2ae146f1ceac479135227f.css" integrity="sha512-5gidh3AKBsqjhsFbrA4fJXIO8Fmz4GXAo3UCYX9D1eHvVNHBDj9L53PrBx6kroC0Z3X60a0q4UbxzqxHkTUifw=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://example.org/images/favicon.ico" />

  
  
  
  
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HY9XRSX5QQ"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-HY9XRSX5QQ', { 'anonymize_ip': false });
}
</script>

  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

    <header id="header">
  <a href="https://example.org/">
  
    <div id="logo" style="background-image: url(https://example.org/images/logo.png)"></div>
  
  <div id="title">
    <h1>The poetry of (in)security</h1>
  </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="Menu"><i class="fas fa-bars fa-2x" aria-hidden="true"></i></a>
      </li>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/post">Posts</a></li>
      
        <li><a href="/tags">Tags</a></li>
      
        <li><a href="/whoami">Whoami</a></li>
      
    </ul>
  </div>
</header>



    
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <div class="content" itemprop="articleBody">
  
    <p>I have been playing around with the HackRF for the past couple of weeks and progressively exploring the Radio Frequency spectrum. In this post I&rsquo;ll take you through how to sniff GSM traffic. I&rsquo;ll be specifically monitoring the <a href="https://en.wikipedia.org/wiki/Um_interface"><strong>Um interface</strong></a>. This in the air interface between the Mobile Station (MS) and the Base Transceiver Station (BTS). The MS in this case will be the mobile phone while the BTS is what the phone connects to on the Mobile network. The BTS is usually hosted on towers which you can spot in various locations. Here is what a typical one looks like.</p>
<p><img src="/images/BTS.jpg" alt="alt"></p>
<p>We first ensure that our HackRF is well set up as detailed in <a href="https://www.ckn.io/blog/2015/10/11/the-hackrf-one-first-steps/"><strong>this earlier post</strong></a>.
This setup is tailored to Archlinux but other linux distros closely follow the same process.
Next we install <a href="https://github.com/ptrkrysik/gr-gsm"><strong>gr-gsm</strong></a> which consists of gnuradio blocks and tools for receiving GSM transmissions.</p>
<h1 id="setting-up-gr-gsm">Setting up gr-gsm</h1>
<p>Install libosmocore libraries</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>yaourt -S libosmocore	
</span></span></code></pre></div><p>Install gr-gsm</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/ptrkrysik/gr-gsm
</span></span><span style="display:flex;"><span>cd gr-gsm
</span></span><span style="display:flex;"><span>mkdir build
</span></span><span style="display:flex;"><span>cd build
</span></span><span style="display:flex;"><span>cmake ..
</span></span><span style="display:flex;"><span>make
</span></span><span style="display:flex;"><span>sudo make install
</span></span><span style="display:flex;"><span>sudo ldconfig
</span></span></code></pre></div><p>Add the path of the gr-gsm blocks to gnuradio</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nano ~/.gnuradio/config.conf 	
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">[</span>grc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>	local_blocks_path<span style="color:#f92672">=</span>/usr/local/share/gnuradio/grc/blocks
</span></span></code></pre></div><p>Move gr-gsm library and python modules to correct location (depends on your environment).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mv /usr/local/lib/python2.7/site-packages/grgsm /usr/lib/python2.7/site-packages/
</span></span><span style="display:flex;"><span>sudo mv /usr/local/lib/libgnuradio-grgsm.so /usr/lib/
</span></span></code></pre></div><p>Next we will set up kalibrate-hackrf which we will use to find what GSM frequencies to sniff on.</p>
<h1 id="setting-up-kalibrate-hackrf">Setting up kalibrate-hackrf</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/scateu/kalibrate-hackrf.git
</span></span><span style="display:flex;"><span>cd kalibrate-hackrf
</span></span><span style="display:flex;"><span>./bootstrap
</span></span><span style="display:flex;"><span>./configure
</span></span><span style="display:flex;"><span>make
</span></span><span style="display:flex;"><span>sudo make install
</span></span></code></pre></div><h1 id="finding-gsm-frequencies">Finding GSM frequencies</h1>
<p>With our prerequisites done, the next step is to find GSM frequencies to listen on. First we consult <a href="http://www.worldtimezone.com/gsm.html"><strong>this site</strong></a> to identify GSM bands used by our local providers.</p>
<p><img src="/images/gsm_bands.png" alt="alt"></p>
<p>Let&rsquo;s concentrate on the 900MHz band for now.
We use kalibrate-hackrf (kal) to find the frequencies as below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kal -s GSM900 -g <span style="color:#ae81ff">40</span> -l <span style="color:#ae81ff">40</span>
</span></span></code></pre></div><p><code>-s</code> is the band to scan, <code>-g</code> is the baseband gain and <code>-l</code> the interface gain
Let it run for a minute or so and you should get output similar to:</p>
<p><img src="/images/kal.png" alt="alt"></p>
<h1 id="sniffing">Sniffing!</h1>
<p>Let us now use gqrx to confirm the frequencies by tuning in to the first one. In this case <strong>936.4MHz</strong></p>
<p><img src="/images/gqrx_gsm.png" alt="alt"></p>
<p>We can see that the activity is centered around <strong>936.8MHz</strong> so we adjust accordingly and use that as the frequency.
We now start capturing gsm traffic using gr-gsm :). What we do is launch gnuradio companion and open <code>the airprobe_rtlsdr.grc</code> block that is part of gr-gsm and run it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gnuradio-companion airprobe_rtlsdr.grc
</span></span></code></pre></div><p>Tune to <strong>936.8MHz</strong> and if all went well we should get data streaming through the console window.</p>
<p><img src="/images/gr_gsm_traffic.png" alt="alt"></p>
<p>We finally launch wireshark and monitor the loopback interface to see the decoded traffic :)
Here is a sample showing BTS Location details.</p>
<p><img src="/images/gsm_wireshark.png" alt="alt"></p>
<p>So what next after sniffing the traffic?
In subsequent posts I&rsquo;ll explain and show how to interpret the decoded traffic as I explain how GSM communication takes place.
From there I&rsquo;ll demonstrate how to decrypt the traffic. That is where it gets really interesting as we start reading SMS&rsquo;s, listening to calls and so on :).
Till then, happy hacking.</p>
  
  </div>
</article>


    <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2025  CK 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/post">Posts</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/whoami">Whoami</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
</html>
