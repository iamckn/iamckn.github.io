<!DOCTYPE html>
<html><head lang="en"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Sniffing Gsm Traffic - The poetry of (in)security</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="I have been playing around with the HackRF for the past couple of weeks and progressively exploring the Radio Frequency spectrum. In this post I&rsquo;ll take you through how to sniff GSM traffic. I&rsquo;ll be specifically monitoring the Um interface. This in the air interface between the Mobile Station (MS) and the Base Transceiver Station (BTS). The MS in this case will be the mobile phone while the BTS is what the phone connects to on the Mobile network. The BTS is usually hosted on towers which you can spot in various locations. Here is what a typical one looks like." />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Sniffing Gsm Traffic" />
<meta property="og:description" content="I have been playing around with the HackRF for the past couple of weeks and progressively exploring the Radio Frequency spectrum. In this post I&rsquo;ll take you through how to sniff GSM traffic. I&rsquo;ll be specifically monitoring the Um interface. This in the air interface between the Mobile Station (MS) and the Base Transceiver Station (BTS). The MS in this case will be the mobile phone while the BTS is what the phone connects to on the Mobile network. The BTS is usually hosted on towers which you can spot in various locations. Here is what a typical one looks like." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/blog/2015/11/01/2015/11/01/sniffing-gsm-traffic/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2015-11-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2015-11-01T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Sniffing Gsm Traffic"/>
<meta name="twitter:description" content="I have been playing around with the HackRF for the past couple of weeks and progressively exploring the Radio Frequency spectrum. In this post I&rsquo;ll take you through how to sniff GSM traffic. I&rsquo;ll be specifically monitoring the Um interface. This in the air interface between the Mobile Station (MS) and the Base Transceiver Station (BTS). The MS in this case will be the mobile phone while the BTS is what the phone connects to on the Mobile network. The BTS is usually hosted on towers which you can spot in various locations. Here is what a typical one looks like."/>

        <link href="http://localhost:1313/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="http://localhost:1313/css/main.6a0f23ea50fd34b46fee262a5a68e17d458c51a2bc99ba1ba018065de6b180c3.css" />
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="http://localhost:1313/">The poetry of (in)security</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/about">About</a>
		
		<a href="/tags">Tags</a>
		
		
	</nav>
</header>

<main>
  <article>
    <div class="post-container">
      
      <div class="post-content">
        <div class="title">
          <h1 class="title">Sniffing Gsm Traffic</h1>
          <div class="meta">Posted on Nov 1, 2015</div>
        </div>
        
        <section class="body">
          <p>I have been playing around with the HackRF for the past couple of weeks and progressively exploring the Radio Frequency spectrum. In this post I&rsquo;ll take you through how to sniff GSM traffic. I&rsquo;ll be specifically monitoring the <!-- raw HTML omitted --><strong>Um interface</strong><!-- raw HTML omitted -->. This in the air interface between the Mobile Station (MS) and the Base Transceiver Station (BTS). The MS in this case will be the mobile phone while the BTS is what the phone connects to on the Mobile network. The BTS is usually hosted on towers which you can spot in various locations. Here is what a typical one looks like.</p>
<p>{% img /images/BTS.jpg 400 %}</p>
<p>We first ensure that our HackRF is well set up as detailed in <!-- raw HTML omitted --><strong>this earlier post</strong><!-- raw HTML omitted -->.
This setup is tailored to Archlinux but other linux distros closely follow the same process.
Next we install <!-- raw HTML omitted --><strong>gr-gsm</strong><!-- raw HTML omitted --> which consists of gnuradio blocks and tools for receiving GSM transmissions.</p>
<p>###<em><strong>Setting up gr-gsm</strong></em></p>
<p>Install libosmocore libraries</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>yaourt -S libosmocore	
</span></span></code></pre></div><p>Install gr-gsm</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/ptrkrysik/gr-gsm
</span></span><span style="display:flex;"><span>cd gr-gsm
</span></span><span style="display:flex;"><span>mkdir build
</span></span><span style="display:flex;"><span>cd build
</span></span><span style="display:flex;"><span>cmake ..
</span></span><span style="display:flex;"><span>make
</span></span><span style="display:flex;"><span>sudo make install
</span></span><span style="display:flex;"><span>sudo ldconfig
</span></span></code></pre></div><p>Add the path of the gr-gsm blocks to gnuradio</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nano ~/.gnuradio/config.conf 	
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">[</span>grc<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>	local_blocks_path<span style="color:#f92672">=</span>/usr/local/share/gnuradio/grc/blocks
</span></span></code></pre></div><p>Move gr-gsm library and python modules to correct location (depends on your environment).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mv /usr/local/lib/python2.7/site-packages/grgsm /usr/lib/python2.7/site-packages/
</span></span><span style="display:flex;"><span>sudo mv /usr/local/lib/libgnuradio-grgsm.so /usr/lib/
</span></span></code></pre></div><p>Next we will set up kalibrate-hackrf which we will use to find what GSM frequencies to sniff on.</p>
<p>###<em><strong>Setting up kalibrate-hackrf</strong></em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/scateu/kalibrate-hackrf.git
</span></span><span style="display:flex;"><span>cd kalibrate-hackrf
</span></span><span style="display:flex;"><span>./bootstrap
</span></span><span style="display:flex;"><span>./configure
</span></span><span style="display:flex;"><span>make
</span></span><span style="display:flex;"><span>sudo make install
</span></span></code></pre></div><p>###<em><strong>Finding GSM frequencies</strong></em>
With our prerequisites done, the next step is to find GSM frequencies to listen on. First we consult <!-- raw HTML omitted --><strong>this site</strong><!-- raw HTML omitted --> to identify GSM bands used by our local providers.</p>
<p>{% img /images/gsm_bands.png %}</p>
<p>Let&rsquo;s concentrate on the 900MHz band for now.
We use kalibrate-hackrf (kal) to find the frequencies as below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kal -s GSM900 -g <span style="color:#ae81ff">40</span> -l <span style="color:#ae81ff">40</span>
</span></span></code></pre></div><p><strong>-s</strong> is the band to scan, <strong>-g</strong> is the baseband gain and <strong>-l</strong> the interface gain
Let it run for a minute or so and you should get output similar to:</p>
<p>{% img /images/kal.png %}</p>
<p>###<em><strong>Sniffing!</strong></em></p>
<p>Let us now use gqrx to confirm the frequencies by tuning in to the first one. In this case <strong>936.4MHz</strong></p>
<p>{% img /images/gqrx_gsm.png %}</p>
<p>We can see that the activity is centered around <strong>936.8MHz</strong> so we adjust accordingly and use that as the frequency.
We now start capturing gsm traffic using gr-gsm :). What we do is launch gnuradio companion and open <strong>the airprobe_rtlsdr.grc</strong> block that is part of gr-gsm and run it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gnuradio-companion airprobe_rtlsdr.grc
</span></span></code></pre></div><p>Tune to <strong>936.8MHz</strong> and if all went well we should get data streaming through the console window.</p>
<p>{% img /images/gr_gsm_traffic.png %}</p>
<p>We finally launch wireshark and monitor the loopback interface to see the decoded traffic :)
Here is a sample showing BTS Location details.</p>
<p>{% img /images/gsm_wireshark.png %}</p>
<p>So what next after sniffing the traffic?
In subsequent posts I&rsquo;ll explain and show how to interpret the decoded traffic as I explain how GSM communication takes place.
From there I&rsquo;ll demonstrate how to decrypt the traffic. That is where it gets really interesting as we start reading SMS&rsquo;s, listening to calls and so on :).
Till then, happy hacking.</p>
        </section>
        <div class="post-tags">
          
          
          
        </div>
      </div>

      
      
    </div>

    </article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/iamckn" rel="me" title="GitHub"><svg class="feather">
   <use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#github" />
</svg></a><a class="border"></a><a class="soc" href="https://twitter.com/iamckn/" rel="me" title="Twitter"><svg class="feather">
   <use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#twitter" />
</svg></a><a class="border"></a></div>
  <div class="footer-info">
    2025  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>

</div>
    </body>
</html>
